<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô AI Content Bootcamp</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    /* CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
    body { font-family: "Prompt", sans-serif; background: #F0F6FF; color: #003B8E; margin: 0; padding-bottom: 40px; }
    .container { max-width: 550px; margin: auto; padding: 20px; box-sizing: border-box; }
    .banner { width: 100%; border-radius: 16px; overflow: hidden; margin-bottom: 25px; box-shadow: 0 4px 20px rgba(0,59,142,0.2); background: linear-gradient(135deg, #00C6FF, #0072FF); color: white; text-align: center; padding: 40px 20px; box-sizing: border-box; }
    .banner h1 { margin: 0; font-size: 26px; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1); line-height: 1.3; }
    .banner p { margin: 8px 0 0; opacity: 0.95; font-size: 15px; font-weight: 300; }
    .logo-badge { background: rgba(255,255,255,0.25); padding: 6px 14px; border-radius: 20px; font-size: 13px; margin-bottom: 12px; display: inline-block; backdrop-filter: blur(5px); }
    .card { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.04); margin-bottom: 20px; }
    .section-title { font-size: 18px; font-weight: 700; margin: 30px 0 12px; padding-left: 10px; border-left: 5px solid #00C6FF; line-height: 1; color: #003B8E; }
    .tech-grid { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 10px; }
    .tech-badge { background: white; border: 1px solid #E6F7FF; color: #0072FF; padding: 8px 14px; border-radius: 50px; font-size: 13px; font-weight: 500; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
    .agenda-toggle-btn { background: white; color: #003B8E; width: 100%; padding: 15px 20px; border: none; border-radius: 12px; font-family: "Prompt", sans-serif; font-size: 16px; font-weight: 600; display: flex; justify-content: space-between; align-items: center; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: all 0.3s ease; }
    .agenda-toggle-btn:hover { background: #f9fcff; box-shadow: 0 6px 15px rgba(0,0,0,0.08); }
    .agenda-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; background: white; border-radius: 0 0 12px 12px; margin-top: -5px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    .agenda-content.show { max-height: 500px; }
    .agenda-list { padding: 20px; list-style: none; margin: 0; }
    .agenda-list li { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px dashed #eee; font-size: 14px; display: flex; align-items: flex-start; }
    .agenda-list li:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
    .day-badge { background: #E6F7FF; color: #0072FF; font-weight: 700; padding: 2px 8px; border-radius: 6px; margin-right: 10px; font-size: 12px; min-width: 45px; text-align: center; }
    .stats-row { margin-bottom: 14px; }
    .stats-label { font-size: 14px; margin-bottom: 6px; display: flex; justify-content: space-between; color: #444; }
    .stat-max { color: #FF0000 !important; font-weight: 800 !important; font-size: 16px !important; }
    .progress-bg { background: #E1E8F5; height: 12px; border-radius: 6px; overflow: hidden; }
    .progress-fill { background: linear-gradient(90deg, #00C6FF, #0072FF); height: 100%; width: 0%; transition: width 1s ease; border-radius: 6px; }
    .choice-group { display: flex; flex-direction: column; gap: 12px; }
    .choice-btn { border: 2px solid #E1E8F5; padding: 18px; border-radius: 14px; background: white; cursor: pointer; text-align: left; transition: all 0.2s; position: relative; }
    .choice-btn:hover { border-color: #00C6FF; }
    .choice-btn.active { border-color: #0072FF; background: #F0F9FF; box-shadow: 0 4px 12px rgba(0,114,255,0.15); }
    .choice-btn.active::after { content: '\f00c'; font-family: "Font Awesome 6 Free"; font-weight: 900; position: absolute; right: 20px; top: 50%; transform: translateY(-50%); color: #0072FF; font-size: 18px; }
    .choice-title { font-weight: 700; font-size: 16px; display: block; color: #003B8E; margin-bottom: 4px; }
    .choice-desc { font-size: 13px; color: #666; font-weight: 400; }
    .form-group { margin-bottom: 18px; }
    .input-label { display: block; margin-bottom: 8px; font-size: 15px; font-weight: 600; color: #003B8E; }
    .required { color: #FF4D4F; margin-left: 4px; font-size: 16px; }
    input, select { width: 100%; padding: 16px; border: 1px solid #E1E8F5; border-radius: 12px; font-size: 16px; font-family: "Prompt"; background: #FAFCFF; box-sizing: border-box; outline: none; transition: 0.3s; color: #333; }
    input:focus, select:focus { border-color: #0072FF; background: white; box-shadow: 0 0 0 3px rgba(0,114,255,0.1); }
    .submit-btn { width: 100%; background: linear-gradient(90deg, #0072FF, #00C6FF); color: white; border: none; padding: 18px; font-size: 18px; font-weight: 700; border-radius: 50px; cursor: pointer; box-shadow: 0 8px 25px rgba(0,114,255,0.35); margin-top: 15px; transition: transform 0.2s; }
    .submit-btn:active { transform: scale(0.98); }
    .price-tag { text-align: center; margin-top: 12px; font-size: 14px; color: #666; }
    #loading { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.95); z-index:999; flex-direction:column; justify-content:center; align-items:center; }
    .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #0072FF; border-radius: 50%; width: 45px; height: 45px; animation: spin 0.8s linear infinite; margin-bottom: 20px; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <!-- Loading Screen -->
  <div id="loading"><div class="spinner"></div><div style="font-weight: 600; color: #003B8E;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</div></div>

  <div class="container">
    <div class="banner">
      <div class="logo-badge">Chokdee Content</div>
      <h1>AI Content Bootcamp</h1>
      <p>(5 Days) ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå + ‡πÉ‡∏ä‡πâ AI ‡∏à‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ó‡∏≥</p>
    </div>

    <!-- Platforms -->
    <div class="tech-grid">
      <div class="tech-badge">Canva</div>
      <div class="tech-badge">Keynote</div>
      <div class="tech-badge">CapCut</div>
      <div class="tech-badge">Numbers</div>
      <div class="tech-badge">ChatGPT</div>
      <div class="tech-badge">Gemini</div>
      <div class="tech-badge">Facebook</div>
      <div class="tech-badge">Digital Office</div>
      <div class="tech-badge">LINE OA</div>
    </div>

    <!-- AGENDA -->
    <div style="margin-bottom: 25px;"></div>
    <button class="agenda-toggle-btn" onclick="toggleAgenda()">
      <span>‚≠êÔ∏è AGENDA ‡∏™‡∏£‡∏∏‡∏õ 5 ‡∏ß‡∏±‡∏ô</span>
      <i class="fas fa-chevron-down" id="agenda-icon"></i>
    </button>
    <div class="agenda-content" id="agenda-box">
      <ul class="agenda-list">
        <li><span class="day-badge">Day 1</span><span><b>Canva / Keynote</b> ‚Äì ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå + ‡∏ó‡∏≥‡∏†‡∏≤‡∏û</span></li>
        <li><span class="day-badge">Day 2</span><span><b>CapCut / Numbers</b> ‚Äì ‡∏ó‡∏≥‡∏Ñ‡∏•‡∏¥‡∏õ + ‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡∏≤‡∏ô + ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡∏≤‡∏¢</span></li>
        <li><span class="day-badge">Day 3</span><span><b>ChatGPT / Gemini</b> ‚Äì AI Content</span></li>
        <li><span class="day-badge">Day 4</span><span><b>Facebook / Digital Office</b> ‚Äì ‡∏•‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏à‡∏£‡∏¥‡∏á</span></li>
        <li><span class="day-badge">Day 5</span><span><b>LINE OA</b> ‚Äì Broadcast + Rich Menu + ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span></li>
      </ul>
    </div>

    <!-- Stats -->
    <div class="section-title">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Real-time)</div>
    <div class="card">
      <div class="stats-row"><div class="stats-label"><span>8‚Äì12 ‡∏°.‡∏Ñ.</span> <span id="txt-dayA">0%</span></div><div class="progress-bg"><div class="progress-fill" id="bar-dayA"></div></div></div>
      <div class="stats-row"><div class="stats-label"><span>13‚Äì17 ‡∏°.‡∏Ñ.</span> <span id="txt-dayB">0%</span></div><div class="progress-bg"><div class="progress-fill" id="bar-dayB"></div></div></div>
      <div style="margin: 20px 0; border-top: 1px dashed #E1E8F5;"></div>
      <div class="stats-row"><div class="stats-label"><span>19:00 - 21:00</span> <span id="txt-time1">0%</span></div><div class="progress-bg"><div class="progress-fill" id="bar-time1"></div></div></div>
      <div class="stats-row"><div class="stats-label"><span>20:00 - 22:00</span> <span id="txt-time2">0%</span></div><div class="progress-bg"><div class="progress-fill" id="bar-time2"></div></div></div>
      <div style="text-align: center; font-size: 13px; color: #888; margin-top: 15px; background: #f9f9f9; padding: 8px; border-radius: 8px;">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <b id="total-reg" style="color: #003B8E;">...</b> ‡∏ó‡πà‡∏≤‡∏ô</div>
    </div>

    <!-- Form -->
    <div class="section-title" id="section-day">üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></div>
    <div class="choice-group" style="margin-bottom: 20px;">
      <div class="choice-btn" onclick="selectDay('A', this)"><span class="choice-title">A) 8‚Äì12 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568</span><span class="choice-desc">‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò ‚Äì ‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</span></div>
      <div class="choice-btn" onclick="selectDay('B', this)"><span class="choice-title">B) 13‚Äì17 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568</span><span class="choice-desc">‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‚Äì ‡∏®‡∏∏‡∏Å‡∏£‡πå</span></div>
    </div>

    <div class="section-title" id="section-time">‚è∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <span class="required">*</span></div>
    <div class="choice-group">
      <div class="choice-btn" onclick="selectTime('19:00-21:00', this)"><span class="choice-title">‚è∞ 19:00 ‚Äì 21:00 ‡∏ô.</span><span class="choice-desc">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</span></div>
      <div class="choice-btn" onclick="selectTime('20:00-22:00', this)"><span class="choice-title">‚è∞ 20:00 ‚Äì 22:00 ‡∏ô.</span><span class="choice-desc">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</span></div>
    </div>

    <div class="section-title">üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</div>
    <div class="card">
      <div class="form-group"><label class="input-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (10 ‡∏´‡∏•‡∏±‡∏Å) <span class="required">*</span></label><input type="tel" id="phone" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)" maxlength="10" inputmode="numeric" oninput="this.value = this.value.replace(/[^0-9]/g, '')"></div>
      <div class="form-group"><label class="input-label">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label><input type="text" id="fullname" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"></div>
      <div class="form-group"><label class="input-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏• <span class="required">*</span></label><input type="email" id="email" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: name@example.com"></div>
      <div class="form-group"><label class="input-label">LINE ID <span class="required">*</span></label><input type="text" id="lineid" placeholder="‡∏Å‡∏£‡∏≠‡∏Å LINE ID ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô"></div>
      <div class="form-group"><label class="input-label">‡∏™‡∏≤‡∏Ç‡∏≤ <span class="required">*</span></label><input type="text" id="branch" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏≤‡∏Ç‡∏≤"></div>
      <div class="form-group">
        <label class="input-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á <span class="required">*</span></label>
        <select id="position" onchange="toggleOtherPosition()">
          <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option>
          <option>‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</option>
          <option>‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏ß‡∏¢</option>
          <option>‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏®‡∏π‡∏ô‡∏¢‡πå</option>
          <option>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏®‡∏π‡∏ô‡∏¢‡πå</option>
          <option>‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ</option>
          <option>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ</option>
          <option>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™</option>
          <option>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢</option>
          <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
        </select>
      </div>
      <div class="form-group" id="other-position-group" style="display: none;">
        <label class="input-label">‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á <span class="required">*</span></label>
        <input type="text" id="other_position" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
      </div>
    </div>

    <button class="submit-btn" onclick="submitForm()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• & ‡πÑ‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
    <div class="price-tag">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</div>
  </div>

  <script>
    // ‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Deploy as Web App)
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwS3HFz65lBCo9llQJV6Wv-ySvfaYLHECX6v1qswQAHjAtpCsIyGYO_gYQ2uoIEMmB3lw/exec";

    let selectedData = { day: "", time: "" };

    window.onload = function() {
      fetch(WEB_APP_URL + "?action=getStats")
        .then(res => res.json())
        .then(renderStats)
        .catch(err => console.warn("Cannot load stats:", err));
    };

    function renderStats(stats) {
      if (!stats) return;
      document.getElementById("total-reg").innerText = stats.total;
      updateBar("bar-dayA", "txt-dayA", stats.dayA, stats.total);
      updateBar("bar-dayB", "txt-dayB", stats.dayB, stats.total);
      updateBar("bar-time1", "txt-time1", stats.time1, stats.total);
      updateBar("bar-time2", "txt-time2", stats.time2, stats.total);
      
      ['txt-dayA', 'txt-dayB', 'txt-time1', 'txt-time2'].forEach(id => document.getElementById(id).classList.remove('stat-max'));
      if (stats.dayA > stats.dayB) document.getElementById('txt-dayA').classList.add('stat-max');
      else if (stats.dayB > stats.dayA) document.getElementById('txt-dayB').classList.add('stat-max');
      if (stats.time1 > stats.time2) document.getElementById('txt-time1').classList.add('stat-max');
      else if (stats.time2 > stats.time1) document.getElementById('txt-time2').classList.add('stat-max');
    }

    function updateBar(barId, txtId, val, total) {
      let pct = total === 0 ? 0 : Math.round((val / total) * 100);
      document.getElementById(barId).style.width = pct + "%";
      document.getElementById(txtId).innerText = pct + "% (" + val + " ‡∏Ñ‡∏ô)";
    }

    function toggleAgenda() {
      const box = document.getElementById('agenda-box');
      const icon = document.getElementById('agenda-icon');
      if (box.classList.contains('show')) { box.classList.remove('show'); icon.classList.remove('fa-chevron-up'); icon.classList.add('fa-chevron-down'); }
      else { box.classList.add('show'); icon.classList.remove('fa-chevron-down'); icon.classList.add('fa-chevron-up'); }
    }

    function selectDay(val, el) {
      const mappedValue = val === 'A' ? '8‚Äì12 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568' : '13‚Äì17 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568';
      const group = el.closest('.choice-group');
      if (el.classList.contains('active')) { selectedData.day = ""; el.classList.remove('active'); } 
      else { group.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('active')); el.classList.add('active'); selectedData.day = mappedValue; }
    }

    function selectTime(val, el) {
      const group = el.closest('.choice-group');
      if (el.classList.contains('active')) { selectedData.time = ""; el.classList.remove('active'); } 
      else { group.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('active')); el.classList.add('active'); selectedData.time = val; }
    }

    function toggleOtherPosition() {
      const pos = document.getElementById('position').value;
      const otherGroup = document.getElementById('other-position-group');
      if (pos === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') otherGroup.style.display = 'block'; else { otherGroup.style.display = 'none'; document.getElementById('other_position').value = ''; }
    }

    function submitForm() {
      const phoneInput = document.getElementById('phone').value.trim();
      let positionValue = document.getElementById('position').value;
      const otherPositionValue = document.getElementById('other_position').value.trim();
      if (positionValue === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') positionValue = otherPositionValue;

      const form = {
        fullname: document.getElementById('fullname').value.trim(),
        phone: phoneInput,
        email: document.getElementById('email').value.trim(),
        lineid: document.getElementById('lineid').value.trim(),
        branch: document.getElementById('branch').value.trim(),
        position: positionValue,
        day: selectedData.day,
        time: selectedData.time
      };

      if(!form.day) { alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å '‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' ‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å"); document.getElementById('section-day').scrollIntoView({behavior:'smooth',block:'center'}); return; }
      if(!form.time) { alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' ‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å"); document.getElementById('section-time').scrollIntoView({behavior:'smooth',block:'center'}); return; }
      if(!form.phone || form.phone.length !== 10) { alert("‚ö†Ô∏è ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 10 ‡∏´‡∏•‡∏±‡∏Å"); document.getElementById('phone').focus(); return; }
      if(!form.fullname || !form.email || !form.lineid || !form.branch || !positionValue) { alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á"); return; }
      if(document.getElementById('position').value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' && !otherPositionValue) { alert("‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"); document.getElementById('other_position').focus(); return; }

      document.getElementById('loading').style.display = 'flex';
      
      fetch(WEB_APP_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'register', form: form }),
      })
      .then(res => res.json())
      .then(res => {
        
        // CASE 1: ‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
        if(res.status === "ALREADY_PAID") {
           alert("‚úÖ ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ô‡∏µ‡πâ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß\n‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏û‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ");
           window.location.href = WEB_APP_URL + "?page=success"; 
        } 
        // CASE 2: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡πà‡∏≤‡∏¢) ‡∏´‡∏£‡∏∑‡∏≠ ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏´‡∏°‡πà
        else if (res.status === "UPDATE_PENDING") {
           alert("‚ÑπÔ∏è ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô\n‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ");
           window.location.href = WEB_APP_URL + "?page=payment&rowid=" + res.rowid + "&price=" + res.price;
        } 
        else if (res.status === "NEW") {
           // ‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏´‡∏°‡πà ‡∏õ‡∏Å‡∏ï‡∏¥
           window.location.href = WEB_APP_URL + "?page=payment&rowid=" + res.rowid + "&price=" + res.price;
        }
        else {
           alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + (res.message || "Unknown error"));
           document.getElementById('loading').style.display = 'none';
        }
      })
      .catch(err => {
        document.getElementById('loading').style.display = 'none';
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: " + err.message);
      });
    }
  </script>
</body>
</html>
