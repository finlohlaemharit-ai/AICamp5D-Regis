<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ó‡∏≥‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå + ‡πÉ‡∏ä‡πâ AI</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
body {
  font-family: "Prompt", sans-serif;
  background: #f5f8ff;
  padding: 20px;
}
.container {
  max-width: 480px;
  margin: auto;
  background: white;
  padding: 22px;
  border-radius: 14px;
  box-shadow: 0 0 12px rgba(0,0,0,0.08);
}
h2 {
  text-align: center;
  color: #003B8E;
}
input, button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 15px;
}
button {
  background: #003B8E;
  color: white;
  border: none;
  cursor: pointer;
}
.success-box {
  display: none;
  text-align: center;
  padding: 20px;
}
</style>
</head>

<body>
<div class="container">

  <h2>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ó‡∏≥‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå + ‡πÉ‡∏ä‡πâ AI</h2>

  <div id="formBox">
    <input type="text" id="fullname" placeholder="‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required />
    <input type="text" id="phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£" required />
    <input type="email" id="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" required />
    <input type="text" id="lineid" placeholder="LINE ID (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" />

    <label>‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
    <input type="file" id="slip" accept="image/*" required />

    <button onclick="submitForm()">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
  </div>

  <div id="successBox" class="success-box">
    <h3>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üíô</h3>
    <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏Ñ‡∏£‡∏±‡∏ö</p>
    <a href="https://line.me/ti/g/fmMXxuHaw-">
      <button style="background:#06C755;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</button>
    </a>
  </div>

</div>


<script>
function submitForm() {
  const fullname = document.getElementById("fullname").value;
  const phone = document.getElementById("phone").value;
  const email = document.getElementById("email").value;
  const lineid = document.getElementById("lineid").value;
  const slipFile = document.getElementById("slip").files[0];

  if (!fullname || !phone || !email || !slipFile) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const base64Slip = e.target.result.split(",")[1];

    const payload = {
      fullname,
      phone,
      email,
      lineid,
      slip: base64Slip
    };

    fetch("https://script.google.com/macros/s/AKfycbwRkD61b9PKrrwam1pHbIUKIs04D26ZpULyDZS4ylvw83KwlBzSBy5AJlVtuk8vtXLqaw/exec", {   // <<<<<<<< ‡πÉ‡∏™‡πà URL Web App Deployment ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
      method: "POST",
      body: new URLSearchParams(payload),
    })
    .then(res => res.json())
    .then(data => {
      if (data.status === "success") {
        document.getElementById("formBox").style.display = "none";
        document.getElementById("successBox").style.display = "block";
      } else {
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
      }
    });
  };

  reader.readAsDataURL(slipFile);
}
</script>
</body>
</html>
